const mainNav=document.querySelector(".main-nav"),sidebar=document.querySelector(".sidebar"),surahsContainer=document.querySelector(".surahs .container"),dailyPrayerContainer=document.querySelector(".daily-prayer-page .container"),timeListContainer=document.querySelector(".time-list"),versesContainer=document.querySelector(".verses"),asmaulHusnaContainer=document.querySelector(".asmaul-husna-page .container"),prayerIntentionsContainer=document.querySelector(".prayer-intentions-page .container"),audioEl=document.querySelector(".audio"),themeToggle=document.querySelector(".check-toggle"),footer=document.querySelector("footer"),offlineSection=document.querySelector(".offline"),sidebarLinks=sidebar.querySelectorAll(".link"),loader=document.querySelector(".loader"),pages=document.querySelectorAll(".page"),surahPage=pages[0];"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/serviceWorker.js").then(e=>console.log("Service worker registered")).catch(e=>console.log("Service worker not registered",e))}),sidebarLinks.forEach((e,a)=>{e.addEventListener("click",()=>{sidebar.classList.remove("active")}),1===a?e.addEventListener("click",async()=>{pages[a+1].classList.add("active"),showLoader();const e=await fetch("https://api.jsonbin.io/b/61b7de1662ed886f915faabc"),n=await e.json(),t=await n;showDailyPrayer(t),hideLoader()}):2===a?e.addEventListener("click",async()=>{pages[a-1].classList.add("active"),showLoader();const e=await fetch("https://api.techniknews.net/ipgeo/"),n=await e.json(),t=await n;getLocation(t.city)}):3===a?e.addEventListener("click",async()=>{pages[a].classList.add("active"),showLoader();const e=await fetch("https://api.jsonbin.io/b/61ba38d9229b23312cdc1055"),n=await e.json(),t=await n;showAsmaulHusna(t),hideLoader()}):4===a&&e.addEventListener("click",async()=>{pages[a].classList.add("active"),showLoader();const e=await fetch("https://api.jsonbin.io/b/61ba8640229b23312cdc30b6"),n=await e.json(),t=await n;showPrayerIntentions(t),hideLoader()})});const showAsmaulHusna=e=>{document.body.style.overflowY="hidden",mainNav.innerHTML='\n  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>\n  <li class="logo">Asmaul Husna</li>',e.forEach(e=>{asmaulHusnaContainer.innerHTML+=`<div class="primary-card shadow">\n    <h2 class="name">${e.urutan}. ${e.latin}</h2>\n    <p class="arab">${e.arab}</p>\n    <p class="text-gray">${e.arti}</p>\n  </div>`})},showPrayerIntentions=e=>{document.body.style.overflowY="hidden",mainNav.innerHTML='\n  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>\n  <li class="logo">Niat-Niat Sholat</li>\n  ',e.forEach(e=>{prayerIntentionsContainer.innerHTML+=`<div class="primary-card shadow">\n    <h2 class="name">${e.name}</h2>\n    <p class="arab">${e.arab}</p>\n    <p class="latin">${e.latin}</p>\n    <p class="means">${e.means}</p>\n </div>`})},getLocation=async e=>{const a=await fetch(`https://api.banghasan.com/sholat/format/json/kota/nama/${e}`),n=await a.json(),t=(await n).kota[0].id;getAdzan(t,e)},getAdzan=async(e,a)=>{showLoader();const n=(new Date).toLocaleDateString("en-CA"),t=await fetch(`https://api.banghasan.com/sholat/format/json/jadwal/kota/${e}/tanggal/${n}`),s=await t.json(),i=await s;showAdzan(i.jadwal.data,a),hideLoader()},showAdzan=(e,a)=>{const n={location:document.querySelector(".adzan-page .location"),name:document.querySelector(".adzan-page .name"),time:document.querySelector(".adzan-page .time"),timeIcon:document.querySelector(".adzan-page .time-icon"),date:document.querySelector(".adzan-page .date")};document.body.style.overflowY="hidden",mainNav.innerHTML='\n  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>\n  <li class="logo">Waktu Sholat</li>\n  ',n.location.innerHTML=`<i class="far fa-map-marker-alt"></i> ${a}`;const t={shubuh:{name:"Shubuh",time:e.subuh,icon:"fa-sunrise"},dhuhr:{name:"Dzuhur",time:e.dzuhur,icon:"fa-sun"},ashar:{name:"Ashar",time:e.ashar,icon:"fa-sun"},maghrib:{name:"Maghrib",time:e.maghrib,icon:"fa-sunset"},isya:{name:"Isya",time:e.isya,icon:"fa-moon"}},s=t.shubuh.time,i=t.dhuhr.time,o=t.ashar.time,r=t.maghrib.time,l=t.isya.time,c=new Date,d=`${c.toLocaleString("it-IT",{hour:"2-digit",minute:"2-digit"})}`;d>=s&&d<=i&&(n.name.innerText=t.dhuhr.name,n.timeIcon.classList.replace("fa-none",t.dhuhr.icon),n.time.innerText=i),d>=i&&d<=o&&(n.name.innerText=t.ashar.name,n.timeIcon.classList.replace("fa-none",t.ashar.icon),n.time.innerText=o),d>=o&&d<=r&&(n.name.innerText=t.maghrib.name,n.timeIcon.classList.replace("fa-none",t.maghrib.icon),n.time.innerText=r),d>=r&&d<=l&&(n.name.innerText=t.isya.name,n.timeIcon.classList.replace("fa-none",t.isya.icon),n.time.innerText=l),(d>=l||d<=s)&&(n.name.innerText=t.shubuh.name,n.timeIcon.classList.add("fa-none",t.shubuh.icon),n.time.innerText=s),n.date.innerText=c.toLocaleString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});const h=document.querySelector(".time-list");Object.values(t).forEach(e=>{h.innerHTML+=`<div class="card flex align-center between shadow">\n    <span class="flex align-center">\n       <i class="far fa-fw ${e.icon}"></i>\n       <p class="name">${e.name}</p>\n    </span>\n    <p class="time">${e.time}</p>\n </div>`})},showDailyPrayer=e=>{document.body.style.overflowY="hidden",mainNav.innerHTML='\n  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>\n  <li class="logo">Doa-Doa Harian</li>\n  ',e.forEach(e=>{dailyPrayerContainer.innerHTML+=`<div class="primary-card shadow">\n    <h2 class="name">${e.doa}</h2>\n    <p class="arab">${e.ayat}</p>\n    <p class="latin">${e.latin}</p>\n    <p class="means">${e.artinya}</p>\n </div>`})};window.addEventListener("offline",()=>{navigator.onLine?offlineSection.style.display="none":offlineSection.style.display="grid"}),window.addEventListener("hashchange",e=>{e.oldURL.length>e.newURL.length&&closePage()});let darkTheme=!1;const currentTheme=localStorage.getItem("theme")?localStorage.getItem("theme"):null;if(currentTheme&&(document.documentElement.setAttribute("data-theme",currentTheme),"dark"===currentTheme)){const e=themeToggle.previousElementSibling;themeToggle.checked=!0,e.classList.replace("fa-moon","fa-sun"),darkTheme=!0}const getSurahs=async()=>{const e=await fetch("https://api.quran.sutanlab.id/surah/");showLoader();const a=await e.json(),n=await a.data;showSurahs(n),hideLoader()};getSurahs();const showSurahs=e=>{for(let a in e)surahsContainer.innerHTML+=`<a href="#${e[a].name.transliteration.id.toLowerCase()}" class="surah flex shadow" onclick="showSurah(${e[a].number})">\n             <p class="number">${e[a].number}</p>\n             <div>\n              <h3 class="name">${e[a].name.transliteration.id}</h3>\n               <p class="desc text-gray">${e[a].name.translation.id} â€¢ ${e[a].numberOfVerses} ayat</p>\n             </div>\n           </a>`},showSurah=e=>{sidebar.classList.remove("active"),showLoader(),fetch(`https://api.quran.sutanlab.id/surah/${e}`).then(e=>e.json()).then(e=>{getSurah(e.data),hideLoader()}),surahPage.classList.add("active")},getSurah=e=>{let a;for(document.body.style.overflowY="hidden",mainNav.innerHTML=`\n         <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>\n         <li class="logo">${e.name.transliteration.id}</li>\n         <li class="far fa-play toggle" onclick="toggleAudios(this)" data-number="${e.number}"></li>\n         `,a=1===e.number?1:0;a<e.verses.length;a++)versesContainer.innerHTML+=`<ul class="verse">\n         <li class="arab">${e.verses[a].text.arab}</li>\n         <li class="latin">${e.verses[a].number.inSurah}. ${e.verses[a].text.transliteration.en}</li>\n         <li class="means text-gray">${e.verses[a].translation.id}</li>\n         <li class="far fa-play toggle" onclick="toggleAudio(this)" data-audio="${e.verses[a].audio.primary}"></li>\n       </ul>`},toggleAudio=e=>{changeAudioToggles();let a=e.getAttribute("data-audio");e.classList.toggle("play"),audioEl.src=a,e.classList.contains("play")?(e.classList.replace("fa-play","fa-stop"),audioEl.play()):(e.classList.replace("fa-stop","fa-play"),audioEl.pause()),audioEl.onended=(()=>{e.classList.replace("fa-stop","fa-play")})},toggleAudios=e=>{changeAudioToggles();let a=e.getAttribute("data-number");e.classList.toggle("play"),fetch(`https://api.quran.sutanlab.id/surah/${a}`).then(e=>e.json()).then(a=>{playAudios(a.data.verses,e)})},playAudios=(e,a)=>{let n=1;audioEl.src=e[0].audio.primary,a.classList.contains("play")?(audioEl.play(),a.classList.replace("fa-play","fa-stop")):(audioEl.pause(),a.classList.replace("fa-stop","fa-play")),audioEl.onended=(()=>{a.classList.replace("fa-stop","fa-play"),audioEl.src=e[n++].audio.primary,audioEl.play(),a.classList.replace("fa-play","fa-stop")})},closePage=()=>{document.body.style.overflowY="auto",document.querySelectorAll(".page").forEach(e=>{e.classList.remove("active")}),mainNav.innerHTML=`<li class="menu toggle" onclick="showSidebar()"><i class="far fa-bars"></i></li>\n  <li class="logo">Quranible</li>\n  <li class="theme-toggle">\n  <label for="check-toggle" class="far ${!0===darkTheme?"fa-sun":"fa-moon"} toggle"></label>\n  <input type="checkbox" class="check-toggle" id="check-toggle" onchange="setTheme(this)">\n  </li>`,setTimeout(()=>{versesContainer.innerHTML="",dailyPrayerContainer.innerHTML="",timeListContainer.innerHTML="",asmaulHusnaContainer.innerHTML="",prayerIntentionsContainer.innerHTML=""},500)},changeAudioToggles=()=>{document.querySelectorAll(".toggle").forEach(e=>{e.classList.replace("fa-stop","fa-play")})},setTheme=e=>{const a=e.previousElementSibling;e.checked?(a.classList.replace("fa-moon","fa-sun"),darkTheme=!0,document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(a.classList.replace("fa-sun","fa-moon"),darkTheme=!1,document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))},showSidebar=()=>{sidebar.classList.toggle("active")},showLoader=()=>{loader.classList.add("active")},hideLoader=()=>{loader.classList.remove("active")};